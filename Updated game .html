<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Final Dino Game</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{background:#f7f7f7;font-family:sans-serif;overflow:hidden;}
.score{text-align:center;font-size:20px;margin-top:10px;}
.game{width:90vw;max-width:600px;height:200px;border:2px solid #000;margin:40px auto;position:relative;background:#fff;overflow:hidden;touch-action:none;}
.dino{width:40px;height:40px;background:green;position:absolute;bottom:0;left:50px;}
.obstacle{width:20px;height:40px;background:red;position:absolute;bottom:0;}
#startOverlay{position:absolute;width:100%;height:100%;background:rgba(0,0,0,0.6);color:white;font-size:24px;display:flex;justify-content:center;align-items:center;cursor:pointer;z-index:10;}
</style>
</head>
<body>

<div class="score">Score: <span id="score">0</span></div>
<div class="game" id="gameArea">
  <div class="dino" id="dino"></div>
  <div id="startOverlay">Tap to Start</div>
</div>

<script>
const dino = document.getElementById("dino");
const gameArea = document.getElementById("gameArea");
const scoreEl = document.getElementById("score");
const startOverlay = document.getElementById("startOverlay");

let isJumping=false;
let jumpHeight=0;
let velocity=0;
let gravity=-0.55;
let gameSpeed=3.2;
let maxSpeed=12;
let obstacles=[];
let score=0;
let gameRunning=false;
let maxJumpHeight=120; // prevent Dino from going off screen

startOverlay.addEventListener("click", startGame);
startOverlay.addEventListener("touchstart", startGame);

function startGame(e){
  e.preventDefault();
  gameRunning=true;
  startOverlay.style.display="none";
  spawnObstacle();
}

function jump(){
  if(!isJumping && gameRunning){
    isJumping=true;
    velocity=16;
  }
}

document.addEventListener("keydown", e=>{if(e.code==="Space") jump();});
gameArea.addEventListener("touchstart", e=>{e.preventDefault(); jump();});

function spawnObstacle(){
  let obs=document.createElement("div");
  obs.className="obstacle";
  obs.style.left=gameArea.clientWidth+"px";
  gameArea.appendChild(obs);
  obstacles.push(obs);

  let time=Math.random()*1000 + 2000; // 2-3 sec spacing
  if(gameRunning) setTimeout(spawnObstacle,time);
}

function update(){
  if(gameRunning){
    // Jump physics
    if(isJumping || jumpHeight>0){
      velocity+=gravity;
      jumpHeight+=velocity;
      if(jumpHeight<0){jumpHeight=0; velocity=0; isJumping=false;}
      if(jumpHeight>maxJumpHeight){jumpHeight=maxJumpHeight; velocity=0;}
      dino.style.bottom=jumpHeight+"px";
    }

    // Obstacles
    obstacles.forEach((obs,i)=>{
      let left=parseFloat(obs.style.left);
      left-=gameSpeed;
      obs.style.left=left+"px";

      if(left+obs.offsetWidth<0){
        obs.remove();
        obstacles.splice(i,1);
        score++;
        scoreEl.textContent=score;
        if(score%5===0 && gameSpeed<maxSpeed) gameSpeed+=0.3;
      }

      // Collision
      let dinoRect=dino.getBoundingClientRect();
      let obsRect=obs.getBoundingClientRect();
      if(!(dinoRect.right<obsRect.left||dinoRect.left>obsRect.right||dinoRect.bottom<obsRect.top||dinoRect.top>obsRect.bottom)){
        gameOver();
      }
    });
  }
  requestAnimationFrame(update);
}

function gameOver(){
  gameRunning=false;
  alert("Game Over! Score: "+score);
  resetGame();
}

function resetGame(){
  obstacles.forEach(o=>o.remove());
  obstacles=[];
  score=0;
  scoreEl.textContent=score;
  jumpHeight=0;
  velocity=0;
  isJumping=false;
  gameSpeed=3.2;
  startOverlay.style.display="flex";
}

update();
</script>
</body>
</html>
